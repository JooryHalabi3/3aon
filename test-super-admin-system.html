<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Super Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-family: 'Tajawal', sans-serif;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        .btn-success { background: #28a745; }
        .btn-warning { background: #ffc107; color: #212529; }
        .btn-danger { background: #dc3545; }
        
        .result {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            white-space: pre-wrap;
            font-family: monospace;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .warning { background: #fff3cd; color: #856404; }
        
        .user-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }
        
        .user-card {
            background: #e9ecef;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .role-1 { border-left: 4px solid #28a745; }
        .role-2 { border-left: 4px solid #ffc107; }
        .role-3 { border-left: 4px solid #6c757d; }
        
        input, select {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: 'Tajawal', sans-serif;
        }
        
        .protected-pages {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
        }
        
        .page-card {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 8px;
        }
        
        .status-allowed { background: #28a745; }
        .status-denied { background: #dc3545; }
        .status-unknown { background: #6c757d; }
    </style>
</head>
<body>
    <h1>ğŸ›¡ï¸ Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Super Admin</h1>
    
    <div class="test-section">
        <h2>1. Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ</h2>
        <button class="btn" onclick="checkCurrentUser()">ÙØ­Øµ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ</button>
        <div id="current-user-result" class="result"></div>
    </div>

    <div class="test-section">
        <h2>2. Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
        <div>
            <h3>Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ø®ØªØ¨Ø§Ø±:</h3>
            <div class="user-info">
                <div class="user-card role-1">
                    <strong>Super Admin</strong><br>
                    Username: 12341<br>
                    Password: 123456<br>
                    RoleID: 1
                </div>
                <div class="user-card role-2">
                    <strong>Admin Ø¹Ø§Ø¯ÙŠ</strong><br>
                    Username: admin<br>
                    Password: password<br>
                    RoleID: 2
                </div>
                <div class="user-card role-3">
                    <strong>Ù…ÙˆØ¸Ù</strong><br>
                    Username: employee<br>
                    Password: password<br>
                    RoleID: 3
                </div>
            </div>
        </div>
        
        <div>
            <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" value="12341">
            <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" value="123456">
            <button class="btn btn-success" onclick="testLogin()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            <button class="btn btn-warning" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
        </div>
        <div id="login-result" class="result"></div>
    </div>

    <div class="test-section">
        <h2>3. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙŠØ©</h2>
        <div class="protected-pages">
            <div class="page-card">
                <strong>superAdmin.html</strong>
                <span id="status-superAdmin" class="status-indicator status-unknown"></span>
                <br><button class="btn" onclick="testPageAccess('superAdmin.html')">Ø§Ø®ØªØ¨Ø§Ø±</button>
            </div>
            <div class="page-card">
                <strong>complaint-tracking.html</strong>
                <span id="status-complaint-tracking" class="status-indicator status-unknown"></span>
                <br><button class="btn" onclick="testPageAccess('complaint-tracking.html')">Ø§Ø®ØªØ¨Ø§Ø±</button>
            </div>
            <div class="page-card">
                <strong>logs.html</strong>
                <span id="status-logs" class="status-indicator status-unknown"></span>
                <br><button class="btn" onclick="testPageAccess('logs.html')">Ø§Ø®ØªØ¨Ø§Ø±</button>
            </div>
            <div class="page-card">
                <strong>permissions.html</strong>
                <span id="status-permissions" class="status-indicator status-unknown"></span>
                <br><button class="btn" onclick="testPageAccess('permissions.html')">Ø§Ø®ØªØ¨Ø§Ø±</button>
            </div>
            <div class="page-card">
                <strong>organizational-directory.html</strong>
                <span id="status-organizational-directory" class="status-indicator status-unknown"></span>
                <br><button class="btn" onclick="testPageAccess('organizational-directory.html')">Ø§Ø®ØªØ¨Ø§Ø±</button>
            </div>
            <div class="page-card">
                <strong>recycle-bin.html</strong>
                <span id="status-recycle-bin" class="status-indicator status-unknown"></span>
                <br><button class="btn" onclick="testPageAccess('recycle-bin.html')">Ø§Ø®ØªØ¨Ø§Ø±</button>
            </div>
        </div>
        <div id="page-access-result" class="result"></div>
    </div>

    <div class="test-section">
        <h2>4. Ø§Ø®ØªØ¨Ø§Ø± API endpoints</h2>
        <button class="btn" onclick="testSuperAdminAPI()">Ø§Ø®ØªØ¨Ø§Ø± Super Admin API</button>
        <button class="btn" onclick="testBackendProtection()">Ø§Ø®ØªØ¨Ø§Ø± Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨Ø§Ùƒ Ø§Ù†Ø¯</button>
        <div id="api-result" class="result"></div>
    </div>

    <div class="test-section">
        <h2>5. Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ù„Ù†Ø¸Ø§Ù…</h2>
        <button class="btn btn-success" onclick="runFullSystemTest()">ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„</button>
        <div id="full-test-result" class="result"></div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:3001/api';
        
        function checkCurrentUser() {
            const resultDiv = document.getElementById('current-user-result');
            const token = localStorage.getItem('token');
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            
            if (!token) {
                resultDiv.className = 'result error';
                resultDiv.textContent = 'âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙˆÙƒÙ† - Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
                return;
            }
            
            resultDiv.className = 'result info';
            resultDiv.textContent = `âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:
Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${user.Username || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„: ${user.FullName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
RoleID: ${user.RoleID || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
RoleName: ${user.RoleName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
Email: ${user.Email || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
Ø§Ù„Ø¯ÙˆØ±: ${getRoleDescription(user.RoleID)}`;
        }

        function getRoleDescription(roleID) {
            switch(roleID) {
                case 1: return 'Super Admin (ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª)';
                case 2: return 'Admin Ø¹Ø§Ø¯ÙŠ (Ù…Ù…Ù†ÙˆØ¹ Ù…Ù† ØµÙØ­Ø§Øª Super Admin)';
                case 3: return 'Ù…ÙˆØ¸Ù (Ù…Ù…Ù†ÙˆØ¹ Ù…Ù† ØµÙØ­Ø§Øª Super Admin)';
                default: return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            }
        }

        async function testLogin() {
            const resultDiv = document.getElementById('login-result');
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (!username || !password) {
                resultDiv.className = 'result error';
                resultDiv.textContent = 'âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±';
                return;
            }

            try {
                resultDiv.className = 'result info';
                resultDiv.textContent = 'ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...';
                
                const response = await fetch(`${API_BASE_URL}/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();

                if (data.success) {
                    localStorage.setItem('token', data.data.token);
                    localStorage.setItem('user', JSON.stringify(data.data.employee));
                    
                    resultDiv.className = 'result success';
                    resultDiv.textContent = `âœ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­:
Ø§Ù„Ø§Ø³Ù…: ${data.data.employee.FullName}
RoleID: ${data.data.employee.RoleID}
RoleName: ${data.data.employee.RoleName}
Ø§Ù„Ø¯ÙˆØ±: ${getRoleDescription(data.data.employee.RoleID)}

${data.data.employee.RoleID === 1 ? 
    'ğŸŸ¢ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„ØµÙØ­Ø§Øª Super Admin' : 
    'ğŸ”´ Ù…Ù…Ù†ÙˆØ¹ Ù…Ù† ØµÙØ­Ø§Øª Super Admin'}`;
                    
                    // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    checkCurrentUser();
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = `âŒ ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ${data.message}`;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `âŒ Ø®Ø·Ø£: ${error.message}`;
            }
        }

        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            
            document.getElementById('login-result').className = 'result warning';
            document.getElementById('login-result').textContent = 'âš ï¸ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬';
            
            checkCurrentUser();
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„ØµÙØ­Ø§Øª
            const statusElements = document.querySelectorAll('.status-indicator');
            statusElements.forEach(el => {
                el.className = 'status-indicator status-unknown';
            });
        }

        async function testPageAccess(pageName) {
            const resultDiv = document.getElementById('page-access-result');
            const statusElement = document.getElementById(`status-${pageName.replace('.html', '').replace('-', '-')}`);
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            
            resultDiv.className = 'result info';
            resultDiv.textContent = `ğŸ”„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„ØµÙØ­Ø© ${pageName}...`;
            
            try {
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ØµÙØ­Ø©
                const response = await fetch(`/superAdmin/${pageName}`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('token')}`
                    }
                });
                
                if (response.ok) {
                    if (user.RoleID === 1) {
                        resultDiv.className = 'result success';
                        resultDiv.textContent = `âœ… Ù†Ø¬Ø­ Ø§Ù„ÙˆØµÙˆÙ„ Ù„ØµÙØ­Ø© ${pageName} - Super Admin`;
                        statusElement.className = 'status-indicator status-allowed';
                    } else {
                        resultDiv.className = 'result error';
                        resultDiv.textContent = `âš ï¸ ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ØµÙØ­Ø© Ù„ÙƒÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ÙŠØ³ Super Admin! Ù‡Ø°Ø§ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…`;
                        statusElement.className = 'status-indicator status-denied';
                    }
                } else if (response.status === 403) {
                    if (user.RoleID !== 1) {
                        resultDiv.className = 'result success';
                        resultDiv.textContent = `âœ… ØªÙ… Ù…Ù†Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ Ù„ØµÙØ­Ø© ${pageName} - Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ÙŠØ³ Super Admin`;
                        statusElement.className = 'status-indicator status-denied';
                    } else {
                        resultDiv.className = 'result error';
                        resultDiv.textContent = `âŒ ØªÙ… Ù…Ù†Ø¹ Super Admin Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„! Ù‡Ø°Ø§ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…`;
                        statusElement.className = 'status-indicator status-denied';
                    }
                } else {
                    resultDiv.className = 'result warning';
                    resultDiv.textContent = `âš ï¸ Ø§Ø³ØªØ¬Ø§Ø¨Ø© ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹Ø©: ${response.status} ${response.statusText}`;
                    statusElement.className = 'status-indicator status-unknown';
                }
                
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ${error.message}`;
                statusElement.className = 'status-indicator status-unknown';
            }
        }

        async function testSuperAdminAPI() {
            const resultDiv = document.getElementById('api-result');
            const token = localStorage.getItem('token');
            
            if (!token) {
                resultDiv.className = 'result error';
                resultDiv.textContent = 'âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙˆÙƒÙ† - ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹';
                return;
            }
            
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ğŸ”„ Ø§Ø®ØªØ¨Ø§Ø± Super Admin API endpoints...';
            
            const endpoints = [
                '/api/super-admin/employees',
                '/api/super-admin/system-stats',
                '/api/super-admin/recycle-bin'
            ];
            
            let results = [];
            
            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(`${API_BASE_URL.replace('/api', '')}${endpoint}`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (response.ok) {
                        results.push(`âœ… ${endpoint}: Ù†Ø¬Ø­ Ø§Ù„ÙˆØµÙˆÙ„`);
                    } else if (response.status === 403) {
                        results.push(`ğŸ”´ ${endpoint}: ØªÙ… Ø§Ù„Ù…Ù†Ø¹ (403)`);
                    } else {
                        results.push(`âš ï¸ ${endpoint}: ${response.status} ${response.statusText}`);
                    }
                } catch (error) {
                    results.push(`âŒ ${endpoint}: Ø®Ø·Ø£ - ${error.message}`);
                }
            }
            
            resultDiv.className = 'result info';
            resultDiv.textContent = results.join('\n');
        }

        async function testBackendProtection() {
            const resultDiv = document.getElementById('api-result');
            
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ğŸ”„ Ø§Ø®ØªØ¨Ø§Ø± Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨Ø§Ùƒ Ø§Ù†Ø¯...';
            
            // Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø¯ÙˆÙ† ØªÙˆÙƒÙ†
            try {
                const response = await fetch(`${API_BASE_URL}/super-admin/employees`);
                const noTokenResult = response.status === 401 ? 
                    'âœ… ØªÙ… Ù…Ù†Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ Ø¨Ø¯ÙˆÙ† ØªÙˆÙƒÙ† (401)' : 
                    `âŒ Ù„Ù… ÙŠØªÙ… Ù…Ù†Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ Ø¨Ø¯ÙˆÙ† ØªÙˆÙƒÙ†: ${response.status}`;
                
                resultDiv.textContent = `Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨Ø§Ùƒ Ø§Ù†Ø¯:
${noTokenResult}`;
                
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­Ù…Ø§ÙŠØ©: ${error.message}`;
            }
        }

        async function runFullSystemTest() {
            const resultDiv = document.getElementById('full-test-result');
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ğŸ”„ ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ù„Ù†Ø¸Ø§Ù…...';
            
            let testResults = [];
            
            // Ø§Ø®ØªØ¨Ø§Ø± 1: ÙØ­Øµ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            const token = localStorage.getItem('token');
            
            if (!token) {
                testResults.push('âŒ Ø§Ø®ØªØ¨Ø§Ø± 1: Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙˆÙƒÙ†');
            } else {
                testResults.push('âœ… Ø§Ø®ØªØ¨Ø§Ø± 1: ÙŠÙˆØ¬Ø¯ ØªÙˆÙƒÙ† ØµØ§Ù„Ø­');
            }
            
            // Ø§Ø®ØªØ¨Ø§Ø± 2: ÙØ­Øµ ØµØ­Ø© Ø§Ù„ØªÙˆÙƒÙ† Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…
            if (token) {
                try {
                    const response = await fetch(`${API_BASE_URL}/auth/me`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    
                    if (response.ok) {
                        testResults.push('âœ… Ø§Ø®ØªØ¨Ø§Ø± 2: Ø§Ù„ØªÙˆÙƒÙ† ØµØ§Ù„Ø­ Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…');
                    } else {
                        testResults.push('âŒ Ø§Ø®ØªØ¨Ø§Ø± 2: Ø§Ù„ØªÙˆÙƒÙ† ØºÙŠØ± ØµØ§Ù„Ø­ Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…');
                    }
                } catch (error) {
                    testResults.push('âŒ Ø§Ø®ØªØ¨Ø§Ø± 2: Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ†');
                }
            }
            
            // Ø§Ø®ØªØ¨Ø§Ø± 3: ÙØ­Øµ RoleID
            if (user.RoleID === 1) {
                testResults.push('âœ… Ø§Ø®ØªØ¨Ø§Ø± 3: Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Super Admin (RoleID = 1)');
            } else if (user.RoleID) {
                testResults.push(`ğŸ”´ Ø§Ø®ØªØ¨Ø§Ø± 3: Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ÙŠØ³ Super Admin (RoleID = ${user.RoleID})`);
            } else {
                testResults.push('âŒ Ø§Ø®ØªØ¨Ø§Ø± 3: RoleID ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
            }
            
            // Ø§Ø®ØªØ¨Ø§Ø± 4: Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„ØµÙØ­Ø§Øª Ù…Ø­Ù…ÙŠØ©
            const protectedPages = ['superAdmin.html', 'logs.html', 'permissions.html'];
            for (const page of protectedPages) {
                try {
                    const response = await fetch(`/superAdmin/${page}`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    
                    if (user.RoleID === 1) {
                        if (response.ok) {
                            testResults.push(`âœ… Ø§Ø®ØªØ¨Ø§Ø± 4.${page}: Super Admin ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„ÙˆØµÙˆÙ„`);
                        } else {
                            testResults.push(`âŒ Ø§Ø®ØªØ¨Ø§Ø± 4.${page}: Super Admin Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„ÙˆØµÙˆÙ„!`);
                        }
                    } else {
                        if (response.status === 403) {
                            testResults.push(`âœ… Ø§Ø®ØªØ¨Ø§Ø± 4.${page}: ØªÙ… Ù…Ù†Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Super Admin`);
                        } else {
                            testResults.push(`âŒ Ø§Ø®ØªØ¨Ø§Ø± 4.${page}: Ù„Ù… ÙŠØªÙ… Ù…Ù†Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Super Admin!`);
                        }
                    }
                } catch (error) {
                    testResults.push(`âŒ Ø§Ø®ØªØ¨Ø§Ø± 4.${page}: Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±`);
                }
            }
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            const successCount = testResults.filter(r => r.startsWith('âœ…')).length;
            const totalTests = testResults.length;
            
            resultDiv.className = successCount === totalTests ? 'result success' : 'result warning';
            resultDiv.textContent = `Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø§Ù…Ù„ (${successCount}/${totalTests}):

${testResults.join('\n')}

${successCount === totalTests ? 
    'ğŸ‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù†Ø¬Ø­Øª! Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.' :
    'âš ï¸ Ø¨Ø¹Ø¶ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙØ´Ù„Øª. ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù†Ø¸Ø§Ù….'}`;
        }

        // ÙØ­Øµ Ø£ÙˆÙ„ÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('load', function() {
            checkCurrentUser();
        });
    </script>
</body>
</html>
